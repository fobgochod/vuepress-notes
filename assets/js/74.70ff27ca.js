(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{641:function(s,t,a){"use strict";a.r(t);var n=a(13),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"c10k问题及nio精讲和io模型性能压测"}},[s._v("C10K问题及NIO精讲和IO模型性能压测")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://www.kegel.com/c10k.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.kegel.com/c10k.html"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"查看路由表"}},[s._v("查看路由表")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("route -n\nroute "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -host "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".110.100 gw "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".150.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("windows 虚拟机 VMware NAT Service")]),s._v(" "),a("h3",{attrs:{id:"bio"}},[s._v("BIO")]),s._v(" "),a("ul",[a("li",[s._v("BIO弊端")]),s._v(" "),a("li",[s._v("阻塞 accept recv")]),s._v(" "),a("li",[s._v("不阻塞只有抛线程")]),s._v(" "),a("li",[s._v("因为阻塞才要抛出线程，才能满足一个服务端接受更多的客户端去处理")])]),s._v(" "),a("h3",{attrs:{id:"nio"}},[s._v("NIO")]),s._v(" "),a("ul",[a("li",[s._v("JDK nio -> new io")]),s._v(" "),a("li",[s._v("OS nio -> NONBLOCKING IO")]),s._v(" "),a("li",[s._v("优势：\n"),a("ul",[a("li",[s._v("可以用1个或者多个线程解决IO连接处理问题")])])]),s._v(" "),a("li",[s._v("问题：\n"),a("ul",[a("li",[s._v("单线程模型 accept recv 不阻塞 循环系统调用")]),s._v(" "),a("li",[s._v("O(n)复杂recv 很多调用无意义，浪费的（调用：计组：系统调用）")])])])]),s._v(" "),a("h3",{attrs:{id:"追踪系统调用"}},[s._v("追踪系统调用")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译 追踪")]),s._v("\njavac SocketNIO.java "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strace")]),s._v(" -ff -o out java SocketNIO\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"ulimit-单个进程可以创建文件描述符"}},[s._v("ulimit 单个进程可以创建文件描述符")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -a\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -SHn "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/security/limits.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"整个内核可以创建最多文件描述符"}},[s._v("整个内核可以创建最多文件描述符")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 由内核估算，1G大概10万文件描述符")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /proc/sys/fs/file-max \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("382467")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/security/limits.conf \n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" -op pid \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -natp\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);